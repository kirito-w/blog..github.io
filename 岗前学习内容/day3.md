# Day3:
## 局域网的数据传输：
### 数据传输过程：
- 当局域网传输数据时，该局域网内的所有主机都能收到。而在一个局域网当中，除了当前正在进行通信的A主机和B主机以外，还有其他的主机，那A主机是如何将数据成功发送给B主机的呢？
- 实际当主机A想要发数据给主机B的时候，该局域网内的其他主机也都收到了该数据，只不过除了主机B以外，其他主机`识别到该数据并不是发给自己的`，此时其他主机就把收到的数据`丢弃`了。
- 每个主机如何判断该数据是否是发送给自己的？
    - 在局域网中发送的数据实际叫做`MAC数据帧`，在这个MAC数据帧的`报头`当中会`包含`两个字段，分别叫做`源MAC地址和目的MAC地址`。
    - `每一台计算机都至少配有一张网卡`，而每一张网卡在出厂时就已经内置了一个48位的序列号，我们将这个序列号称之为“MAC地址”，这个MAC地址是`全球唯一`的。
    - 在局域网中进行通信的时候，每一个主机在收到一个MAC数据帧后，都会提取该MAC数据帧的报头，找到对应的目的MAC地址与自己的MAC地址进行比对。如果该MAC地址与自己的MAC地址不匹配，则直接将该MAC数据帧丢弃，只有MAC地址匹配时，该主机才会将该数据帧的有效载荷继续向上进行交付处理。
----------------------------------------------------------------------
### 数据碰撞
- 什么是碰撞?
    - 当主机A在向主机B发送数据时，其他主机彼此之间可能也正在进行通信，甚至主机A在和主机B通信的同时也在和其他主机进行通信。
    - 但`同一局域网中的所有主机`在通信时，`使用`的都是一个`共同的通信信道`，因此如果局域网内的`多台主机同时进行通信`，此时这些`数据`之间就可能会`相互干扰`。
    - 每一个局域网都可以看作是一个碰撞域，如果某个主机发送出去的数据与其他主机发送的数据之间产生了干扰，我们就称这两台主机在该碰撞域中发生了碰撞。
- 如何判断发送出去的数据是否发生了碰撞?
    - 因为发送到局域网当中的数据是所有主机都能够收到的，因此当一个主机将数据发送出去后，该`主机本身也是能够收到`这个数据的。当该主机收到该数据后就可以将其与之前发送出去的数据进行对比，如果发现收到的数据与之前发送出去的数据不相同，则说明在发送过程中发生了碰撞。
    - 也就是说，`主机`实际是能够通过某种方式，`知道曾经发送出去的数据是否发生了碰撞`的。\
- 发生碰撞后是如何处理的？
    - 当一个主机发现自己发送出去的数据产生了碰撞，此时该主机就要执行“碰撞避免”算法。
    - “碰撞避免”算法实际很简单：`当一个主机发送出去的数据产生了碰撞，那么该主机可以选择等一段时间后，再重新发送该数据`。这就像现实生活中的两个人同时想要说话，此时对方就都会说“你先说吧”，这实际上就是一种碰撞避免。
    - 需要注意的是，实际在`网络通信压力不大的时候发生碰撞的概率是不大`的，我们不要太小瞧计算机的处理速度，也不要太小瞧网线传播数据的速度。
- 与碰撞相关的一种局域网攻击机制:
    - 如果局域网内的某台主机`一直向该局域网内发送一些无用的数据`，那么其他主机一发数据就会产生碰撞，此时该局域网也就瘫痪了，这实际就是局域网本身的一个攻击原理。但需要注意的是，这台一直发送“垃圾数据”的主机，`必须`要通过某种方式`绕过“碰撞避免”算法`，`否则`当其发送的数据产生碰撞后，该主机`自己也会执行“碰撞避免”算法`。

=====================================================================================
## 跨网络的主机通信:
### 上面说的都是同一局域网内的主机之间的通信，那跨局域网的两台主机之间是如何进行通信的呢？
- `局域网之间`都是`通过路由器连接`起来的，因此一个路由器`至少`能够横跨`两个局域网`。
- 而这些被路由器级联局域网都`认为`，该`路由器`就是`本局域网内的一台主机`，因此路由器`可以`和这些`局域网内的任意一台主机`进行`直接通信`。
- 比如局域网1当中的主机A想要和局域网2当中的主机H进行通信，那么主机A可以先将数据发送给路由器，然后路由器再将数据转发给局域网2当中的主机H。  
![](img/%E5%9B%BE%E7%89%8723.png)

----------------------------------------------------------------------
### 路由器为什么能够“认路”？
- `一个路由器可能会级联多个局域网`，当路由器需要将一个局域网的数据转发到另一个局域网时，路由器如何知道该数据应该转发到哪一个局域网的呢？
- 路由器其实是`通过IP地址来确定数据的转发方向`的，因特网上的`每台计算机`都有一个`唯一的IP地址`，而在`数据向下进行封装`时，在`网络层`封装的报头当中就会`包含`两个字段，分别是`源IP地址和目的IP地址`。
- 当路由器需要将一个局域网的数据转发到另一个局域网时，在`路由器的链路层`会先将数据的在`当前局域网对应的底层报头去掉`，然后将剩下的数据`向上交付给网络层`，此时在网络层就可以`获取`到该数据`对应的目的IP地址`，然后路由器就可以`根据该IP地址`在`路由表`当中进行`查找`，最终就能够`确认`该数据应该`发送到哪一个局域网`。
----------------------------------------------------------------------
### 屏蔽底层的差异
- IP地址的存在除了帮助数据”路由"以外，还有一个很重要的作用，那就是`屏蔽了底层网络的差异`。
- `对于`通信主机双方的`IP层及其往上的协议来说`，它们并`不需要关心底层采用`的是以太网还是令牌环网，它们`认为`只要`填写了源IP地址和目的IP地址就能够将数据发送出去`，因此现在`主流的网络`也叫做`“IP网络”`。

=====================================================================================

## 公网与私网：
- 公网:我们经常所说的互联网
- 私网:一个私有的网络，仅限于内部通信（局域网就是一种私网）
### IP地址不够用时的解决方式：
- 1、DHCP动态地址分配
- 2、NAT网络地址转换（`主要就是用于组建私网`，私网中的主机要么只能内部通信，要么就使用统一一个对外的IP地址上网）

=====================================================================================

## todolist:
- wlanconfig、iwpriv指令学习。

=====================================================================================


