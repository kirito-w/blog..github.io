# 路由器相关知识
## 路由器的基本工作原理
- `路由器本质上是一种网关`，是互联网的一个结点设备。实现的功能是`对不同网络之间的数据包`进行`存储`和`分组转发`。简单来说，大家可以把路由器理解为网络分发工具。
- 路由器上最常见的接口有两个，一个是`WAN口`，一个是`LAN 口` （一般通过看有没有通过DHCP获取到ip地址来判断是否连接成功）。
    - WAN (Wide Area Network)，广域网，通俗讲就是和Modem连接的网线口 —— `wan口连接外网`。
    - LAN （Local Area Network)，局域网，路由和用户之间网线口（比如连接电视/电脑）—— `lan口连接设备`。
## 提高路由器覆盖范围的方式
### AC+AP(星状)
### MESH（网状）
- 无线Mesh网络是一种全新的无线局域网类型。
- 在传统的WLAN中，每个客户端均通过一条与接入点（AP）相连的无线链路访问网络，`用户若要进行相互通信`，`必须首先`访问一个`固定的AP`，这种网络结构称为单跳网络。
- 而在无线Mesh网络中，`AP`可以`采用无线连接的方式进行互连`，并且`AP间可以建立多跳的无线链路`。每个节点之前的通路不再只有一条，每个节点至少与两个节点相互连接，`能更高程度提高稳定性和可靠性`。
- 如下图：
    ![](img/%E5%9B%BE%E7%89%8759.png)  
- 网状结构的好处在于：
    - 其一，`覆盖面积相当广`。
    - 其二，如果`最近的AP由于流量过大而导致拥塞`的话，数据可以`自动重新路由`到一个`通信流量较小的邻近节点`进行传输。以此类推，数据包还可以根据网络的情况，继续路由到与之最近的下一个节点进行传输，直到到达最终目的地为止。这样的访问方式就是前文提到的`多跳访问`。
- `无线Mesh网络比传统网络要更加稳定，信号不容易受阻，大房子多户型多点覆盖范围很少会出现死角的情况。即使是某点网络连接出现问题，节点特有的多通道特性也会让用户继续保持正常上网`。

## IPV6和WIFI6的区别与联系
- `WIFI6`：是一种`无线局域网标准`，`也被称为802.11ax`。它是前一版本WiFi 5（802.11ac）的升级，`提供更快的速度、更好的稳定性和更高的容量`。WiFi 6支持更多的设备同时连接，减少了拥塞问题，并提供更好的性能和能效。
- `IPV6`：是Internet Protocol Version 6的简写，`是互联网协议的最新版本`，用于为互联网上的设备分配唯一的IP地址。`IPv6解决了IPv4中地址不足的问题，并提供了更强大的安全性和可扩展性`。
- 总的来说，IPv6和WiFi 6都是为了提供更快、更安全、更可靠的网络连接而设计的技术，尽管它们在不同的层面上实现了这个目标，但它们可以在一起使用，以获得更好的用户体验。

================================================================================================================================================================

#  计算机网络相关知识：
## 网络层次划分
- 常见的几种分层如下图：![](img/%E5%9B%BE%E7%89%8760.png)
## OSI七层网络模型
- TCP/IP协议毫无疑问是互联网的基础协议，没有它就根本不可能上网，`任何和互联网有关的操作都离不开TCP/IP协议`。
- 不管是OSI七层模型还是TCP/IP的四层、五层模型，`每一层中都要自己的专属协议`，完成自己相应的工作以及与上下层级之间进行沟通。由于OSI七层模型为网络的标准层次划分，所以我们以OSI七层模型为例从下向上进行一一介绍。
    - 1）物理层（Physical Layer）: 
        - 激活、维持、关闭通信端点之间的机械特性、电气特性、功能特性以及过程特性。`该层为上层协议提供了一个传输数据的可靠的物理媒体`。简单的说，物理层确保原始的数据可在各种物理媒体上传输。物理层记住`两个重要的设备`名称，`中继器（Repeater，也叫放大器）和集线器`。
    - 2）数据链路层（Data Link Layer）: 
        - 数据链路层在物理层提供的服务的基础上向网络层提供服务，其最基本的服务是将`源自网络层来的数据`可靠地`传输`到相邻节点的`目标机网络层`。
        - 为达到这一目的，数据链路必须具备一系列相应的功能，主要有：如何`将数据组合成数据块`，在数据链路层中称这种数据块为`帧（frame）`，`帧是数据链路层的传送单位`；如何控制帧在物理信道上的传输，包括如何处理传输差错，如何调节发送速率以使与接收方相匹配；以及在两个网络实体之间提供数据链路通路的建立、维持和释放的管理。
        - 数据链路层`在不可靠的物理介质上提供可靠的传输`。该层的作用包括：`物理地址寻址、数据的成帧、流量控制、数据的检错、重发`等。
        - 有关数据链路层的重要知识点：
            - 1> 数据链路层`为网络层提供可靠的数据传输`；
            - 2> `基本数据单位`为`帧`；
            - 3> 主要的协议：`以太网协议`；
            - 4> 两个重要设备名称：`网桥`和`交换机`。
    - 3）网络层（Network Layer）: 
        - 网络层的目的是`实现两个端系统`之间的`数据透明传送`，具体功能包括`寻址和路由选择、连接的建立、保持和终止`等。它提供的服务使传输层不需要了解网络中的数据传输和交换技术。如果您想用尽量少的词来记住网络层，那就是`"路径选择、路由及逻辑寻址"`。
        - 网络层中涉及众多的协议，其中包括`最重要的协议`，也是TCP/IP的核心协议——`IP协议`。`IP协议`非常简单，仅仅`提供不可靠、无连接的传送服务`。IP协议的主要功能有：`无连接数据报传输、数据报路由选择和差错控制`。与IP协议配套使用实现其功能的还有`地址解析协议ARP`、`逆地址解析协议RARP`、因特网报文协议ICMP、因特网组管理协议IGMP。具体的协议我们会在接下来的部分进行总结。
        - 有关网络层的重点为：
            - 1> 网络层负责对`子网间的数据包`进行`路由选择`。此外，网络层还可以实现`拥塞控制`、`网际互连`等功能；
            - 2> `基本数据单位`为`IP数据报`；
            - 3> 重要的设备：`路由器`。
    - 4）传输层（Transport Layer）: 
        - `第一个端到端，即主机到主机的层次`。传输层负责将上层数据分段并提供端到端的、可靠的或不可靠的传输。
        - 有关传输层的重点：
            - 1> 传送的`协议数据单元`称为`段或报文`
            - 2> 包含的主要协议：`TCP协议`（Transmission Control Protocol，传输控制协议）、`UDP协议`（User Datagram Protocol，用户数据报协议）；
            - 3> 重要设备：`网关`。
    - 5）会话层：
        - 会话层管理主机之间的会话进程，即`负责建立、管理、终止进程之间的会话`。会话层还利用在数据中插入校验点来实现数据的同步。
    - 6）表示层：
        - 表示层`对上层数据或信息`进行`变换`以保证一个主机应用层信息可以被另一个主机的应用程序理解。表示层的数据转换包括`数据的加密、压缩、格式转换`等。
    - 7）应用层：
        - 为`操作系统`或`网络应用程序``提供`访问网络服务的`接口`。
        - 会话层、表示层和应用层重点：
            - 1> `数据传输基本单位`为`报文`；
            - 2> 包含的主要协议：FTP（文件传送协议）、Telnet（远程登录协议）、DNS（域名解析协议）、SMTP（邮件传送协议），POP3协议（邮局协议），HTTP协议（Hyper Text Transfer Protocol）。


## 具体作用：
- 物理层（Physical Layer）：负责`传输比特流`，包括电压、光信号等`物理媒介`的特性和传输速率。
- 数据链路层（Data Link Layer）：负责`在物理介质上传输数据帧`，进行逐段传输的控制、错误检测和纠正，以帧为单位传输数据。
- 网络层（Network Layer）：负责`数据包在网络中的传输`，进行`路由选择`以及实现`逻辑上的通信`，处理分组的传输，`确保数据正确到达目的地`。（IP协议，不能可靠传输）
- 传输层（Transport Layer）：负责`端到端`的数据传输，提供`差错恢复和流量控制`。(如TCP协议和UDP协议，是传输层协议)
- 会话层（Session Layer）：负责`建立、维护和终止会话`，`确保数据传输的顺序和正确性`，同时提供`数据传输的同步`。
- 表示层（Presentation Layer）：负责`数据的格式化、加密、解密、压缩、解压缩和编码等转换工作`，使得网络传输的数据能够`在接收端被正确解释`。
- 应用层（Application Layer）：`提供网络服务`给用户。它允许用户访问网络并使用各种网络资源，包括文件、打印机、电子邮件等。
------------------------------------------------------------------------------------------------

## 子网掩码及网络划分
- 随着互连网应用的不断扩大，原先的`IPv4`的`弊端`也逐渐暴露出来，即网络号占位太多，而主机号位太少，所以其`能提供的主机地址也越来越稀缺`，目前除了使用NAT在企业内部利用保留地址自行分配以外，通常都对一个高类别的IP地址进行再划分，以形成多个子网，提供给不同规模的用户群使用。
- 这里主要是`为了在网络分段情况下有效地利用IP地址`，通过`对主机号的高位部分取作为子网号`，从通常的网络位界限中扩展或压缩子网掩码，用来创建某类地址的更多子网。但创建更多的子网时，在每个子网上的可用主机地址数目会比原先减少。
### 什么是子网掩码？
- 子网掩码是`标志两个IP地址是否同属于一个子网`的，也是32位二进制地址，其每一个为1代表该位是网络位，为0代表主机位。它和IP地址一样也是使用点式十进制来表示的。`如果两个IP地址在子网掩码的按位与的计算下所得结果相同，即表明它们共属于同一子网中`。
- 在计算子网掩码时，我们要注意IP地址中的保留地址，即`"0"地址和广播地址`，它们是指主机地址或网络地址全为"0"或"1"时的IP地址，它们代表着本网络地址和广播地址，一般是不能被计算在内的。

------------------------------------------------------------------------------------------------

## 路由选择协议
- 常见的路由选择协议有：RIP协议、OSPF协议。
    - RIP协议 ：底层是贝尔曼福特算法，它选择路由的`度量标准`（metric)是`跳数`，最大跳数是15跳，如果`大于15跳`，它就会`丢弃数据包`。
    - OSPF协议 ：Open Shortest Path First开放式最短路径优先，底层是迪杰斯特拉算法，是链路状态路由选择协议，它选择路由的`度量标准`是`带宽`，`延迟`。

## TCP/IP协议
- `TCP/IP协议是Internet最基本的协议`、Internet国际互联网络的基础，由网络层的IP协议和传输层的TCP协议组成。通俗而言：`TCP负责发现传输的问题，一有问题就发出信号，要求重新传输，直到所有数据安全正确地传输到目的地`。而`IP是给因特网的每一台联网设备规定一个地址`。
- IP层接收`由更低层`（网络接口层例如以太网设备驱动程序）发来的`数据包`，并把该数据包`发送到更高层`---TCP或UDP层；相反，IP层`也把从TCP或UDP层接收来的数据包`传送到`更低层`。
- `IP数据包是不可靠的!!!`，因为IP并`没有做任何事情`来`确认数据包`是否按`顺序发送`的或者`有没有被破坏`，IP数据包中`含有`发送它的主机的地址（`源地址`）和接收它的主机的地址（`目的地址`）。
- TCP是`面向连接`的通信协议，通过`三次握手`建立连接，通讯完成时要拆除连接，由于TCP是`面向连接`的所以`只能用于端到端的通讯`。`TCP提供`的是一种`可靠的数据流服务`，采用"带重传的肯定确认"技术来实现传输的可靠性。TCP还采用一种称为`"滑动窗口"`的方式进行`流量控制`，所谓`窗口实际表示接收能力`，用以`限制发送方的发送速度`。
- 如下图：![](img/%E5%9B%BE%E7%89%8761.png)![](img/%E5%9B%BE%E7%89%8762.png)

- `TCP连接建立过程`：首先Client端发送连接请求报文，Server段接受连接后回复ACK报文，并为这次连接分配资源。Client端接收到ACK报文后也向Server段发生ACK报文，并分配资源，这样TCP连接就建立了。

- `TCP连接断开过程`：假设Client端发起中断连接请求，也就是发送FIN报文。Server端接到FIN报文后，意思是说"我Client端没有数据要发给你了"，但是如果你还有数据没有发送完成，则不必急着关闭Socket，可以继续发送数据。所以你先发送ACK，"告诉Client端，你的请求我收到了，但是我还没准备好，请继续你等我的消息"。这个时候Client端就进入FIN_WAIT状态，继续等待Server端的FIN报文。当Server端确定数据已发送完成，则向Client端发送FIN报文，"告诉Client端，好了，我这边数据发完了，准备好关闭连接了"。Client端收到FIN报文后，"就知道可以关闭连接了，但是他还是不相信网络，怕Server端不知道要关闭，所以发送ACK后进入TIME_WAIT状态，如果Server端没有收到ACK则可以重传。"，Server端收到ACK后，"就知道可以断开连接了"。Client端等待了2MSL后依然没有收到回复，则证明Server端已正常关闭，那好，我Client端也可以关闭连接了。Ok，TCP连接就这样关闭了！

### 为什么要三次握手？
- 在只有两次"握手"的情形下，假设Client想跟Server建立连接，但是却因为中途连接请求的数据报丢失了，故Client端不得不重新发送一遍；这个时候Server端仅收到一个连接请求，因此可以正常的建立连接。但是，有时候Client端重新发送请求不是因为数据报丢失了，而是有可能数据传输过程因为网络并发量很大在某结点被阻塞了，这种情形下Server端将先后收到2次请求，并持续等待两个Client请求向他发送数据...问题就在这里，Cient端实际上只有一次请求，而Server端却有2个响应，`极端的情况可能由于Client端多次重新发送请求数据而导致Server端最后建立了N多个响应在等待`，因而`造成极大的资源浪费`！所以，"三次握手"很有必要！

### 为什么要四次挥手？
- 试想一下，假如现在你是客户端你想断开跟Server的所有连接该怎么做？`第一步`，你自己先`停止向Server端发送数据`，并`等待Server的回复`。但事情还没有完，虽然你自身不往Server发送数据了，但是因为你们之前已经建立好平等的连接了，所以此时他也有主动权向你发送数据；故`Server端还得终止主动向你发送数据`，并`等待你的确认`。其实，说白了就是`保证双方`的一个`合约的完整执行`！

### 使用TCP的协议：FTP（文件传输协议）、Telnet（远程登录协议）、SMTP（简单邮件传输协议）、POP3（和SMTP相对，用于接收邮件）、HTTP协议等。

## DNS协议
- DNS是域名系统(DomainNameSystem)的缩写，该系统用于命名组织到域层次结构中的计算机和网络服务，可以`简单地理解为将URL转换为IP地址`。

## NAT协议
- NAT网络地址转换(Network Address Translation)属接入广域网(WAN)技术，是一种`将私有（保留）地址转化为合法IP地址`的转换技术，它被广泛应用于各种类型Internet接入方式和各种类型的网络中。原因很简单，NAT不仅完美地`解决了lP地址不足的问题`，而且还能够`有效地避免来自网络外部的攻击`，隐藏并保护网络内部的计算机。

## DHCP协议
- DHCP动态主机设置协议（Dynamic Host Configuration Protocol）是一个局域网的网络协议，`使用UDP协议工作`，主要`有两个用途`：
    - 给`内部网络`或`网络服务供应商自动分配IP地址`
    - 给`用户`或者`内部网络管理员`作为对所有计算机`作中央管理的手段`。

## HTTP协议
- `超文本传输协议`（HTTP，HyperText Transfer Protocol)是互联网上应用最为广泛的一种网络协议。`所有的WWW文件都必须遵守这个标准`。
### HTTP 协议包括哪些请求？
- GET：请求`读取`由URL所标志的信息。
- POST：给服务器`添加`信息（如注释）。
- PUT：在给定的URL下`存储一个文档`。
- DELETE：`删除`给定的`URL所标志的资源`。

### HTTP 中， `POST 与 GET 的区别`
- 1）`Get`是从服务器上`获取数据`，`Post`是向服务器`传送数据`。
- 2）Get是把参数数据队列加到提交表单的Action属性所指向的URL中，值和表单内各个字段一一对应，在URL中可以看到。
- 3）`Get`传送的`数据量小`，不能大于2KB；`Post`传送的`数据量较大`，一般被`默认为不受限制`。
- 4）根据HTTP规范，`GET用于信息获取`，而且`应该是安全的和幂等`的。
    - I. 所谓 `安全的` 意味着该操作`用于获取信息而非修改信息`。换句话说，`GET请求一般不应产生副作用`。就是说，它`仅仅是获取资源信息`，就`像数据库查询`一样，不会修改，增加数据，`不会影响资源的状态`。
    - II. `幂等 `的`意味着`对`同一URL的多个请求`应该`返回同样的结果`。

==========================================================================================


## 物理端口、逻辑网口、交换片之间的关系：
## `interface是逻辑网络`如：wan、lan、loopback。`device是实际网络设备`，`可能是物理`的也`可能是虚拟`的，处于`数据链路层`。
### 物理端口
- 物理网口是您路由器或设备上的`实际物理接口`，`通常`标记为`eth0、eth1`等。`每个物理网口对应一个物理端口`，您`可以通过连接网线`将设备`连接到这些物理端口`上。
### 逻辑网口
- 逻辑网口是`基于物理网口创建的虚拟接口`，`用于实现不同功能或配置`。你提到的ra0和eth0.1都是逻辑网口的示例。`逻辑网口`可以用于诸如`VLAN（虚拟局域网）`、`桥接`、`无线网络`等不同的配置。
### 交换片
- 交换片或交换机（`switch`）是`连接物理端口和逻辑网口的关键组件`。交换片`允许数据`在`不同网口`之间进行`交换`，并`控制数据流的路由`。它还`协调物理和逻辑接口之间的通信`，并`处理数据包的转发和过滤`。


## 桥接模式下 DHCP服务器：
- 桥接模式下，DHCP服务器可以运行，但是它的功能将有所不同。
- 在桥接模式下，DHCP服务器仍然可以为连接到桥接网络的设备分配IP地址，但与路由模式下不同，它`不会执行NAT(Network Address Translation)`功能。在桥接模式下，`设备`将`直接获得`来自网络上的`公共IP地址`，而`不是`通过`路由器`上的`NAT`分配`私有IP地址`。


## 局域网中的广播ip：
    - 例如：192.168.10.1/24  广播ip为192.168.10.255

-------

## 路由器、交换机、网关
- **交换机（Router）：**
    - 1、交换机用于在`局域网内部`进行数据交换和传输
    - 2、在`数据链路层`（第二层）工作的设备，用于建立`局域网内部`的通信
    - 3、根据`MAC地址`对`数据包`进行`转发`，实现`局域网内部设备之间的快速数据传输`
    - 4、通常用来连接多台计算机、打印机等设备，实现内部设备之间的通信和数据传输。
- **路由器（Switch）：**
    - 1、用来`连接不同的网络`，实现不同网络之间的数据交换和传输
    - 2、在`网络层`（第三层）工作的设备，用于`网络之间`的通信和数据传输。
    - 3、根据`IP地址`对`数据包`进行`转发`，具有`路由选择、数据包转发`等功能
    - 4、可以确定数据包的传输路径，选择最佳的路由路径来传输数据。
- **网关（Gateway）：**
    - 1、是`连接不同网络`之间的设备，用于实现不同网络之间的通信和数据传输。
    - 2、既可以是硬件设备也可以是软件程序，`用于转换数据包的协议、格式`等，`使数据能够在不同网络之间传输`。
    - 3、可以连接不同类型的网络，`如局域网和互联`网之间，实现数据包在不同网络之间的转发和传输。
    - 4、可以`充当连接不同网络的桥梁`，实现`不同网络之间的通信和数据传输`。

----------------------------------------------------------------

## PPPOE拨号流程图及数据包：
![](img/%E5%9B%BE%E7%89%8767.png)
![](img/%E5%9B%BE%E7%89%8768.png)

## IE802.11 无线相关知识：
- https://e-mailky.github.io/2017-11-10-wifi-introduce

## 如果lan侧不配dns服务器，那么下挂设备获取到的dns服务器是那里来的？
- 如果LAN侧没有配置DNS服务器，下挂设备会尝试`从ISP`（互联网服务提供商）处获取DNS服务器信息(`即从上级获取`)。通常情况下，`ISP会提供默认的DNS服务器地址给用户设备使用`。如果ISP没有提供DNS服务器地址，设备可能无法解析域名或无法连接到互联网。因此，最好在LAN侧配置一个本地的DNS服务器，以确保设备可以正确获取DNS服务器信息并正常访问互联网。